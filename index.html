<html>
<head>
	<link rel="stylesheet" type="text/css" href="http://metricsgraphicsjs.org/css/metricsgraphics.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="http://kovalent.co/mksht/dollaraday/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.js"></script>

	<title>Hey</title>
</head>
<body>
	<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSea6a1NKX9cWEuB-HPmfiwG_lYa-OqeB26G_7HTKXTqIEpo6Q/viewform">Enter more data.</a></p>

	<div id="chart">
	</div>

	<script>

	var JSONURL = 'https://spreadsheets.google.com/feeds/list/1CVtxktOSZxUmDCR8zEdGA5xEdNpB2sK2MtSXC-JIdOU/1/public/basic?alt=json';

	function callback(data){
	    var rows = [];
	    var cells = data.feed.entry;
	    
	    for (var i = 0; i < cells.length; i++){
	        var rowObj = {};
	        rowObj.timestamp = cells[i].title.$t;
	        var rowCols = cells[i].content.$t.split(',');
	        for (var j = 0; j < rowCols.length; j++){
	            var keyVal = rowCols[j].split(':');
	            rowObj[keyVal[0].trim()] = keyVal[1].trim();
	        }
	        rows.push(rowObj);
	        console.log(rowObj.leadsource)
	    }
	    
	    var raw = document.createElement('p');
	    raw.innerText = JSON.stringify(rows);
	    document.body.appendChild(raw);
	}

	$(document).ready(function(){
	    
	    $.ajax({
	        url:JSONURL,
	        success: function(data){
	            callback(data);
	        }
	    });

	});

	</script>

</body>
</html>

